syntax = "proto2";

// python -m grpc_tools.protoc weather.proto --proto_path=. --python_out=. --grpc_python_out=. 

service WeatherHistory {
  rpc GetSummary (Summary) returns (SummaryReturn) {}
  rpc PrecipAnalysis (AnalysisSummary) returns (AnalysisReturn) {}
  rpc GetPrecip (Precip) returns (GetPrecipReturn) {}
}

message Precip {
    required string loc_name = 1;
    required float precip = 2;
    required string operator = 3;
}

message AnalysisSummary {
  required Location location = 1;
  required DateRange daterange = 2;
  required string loc_name = 3;
}

message Summary {
  required Location location = 1;
  required DateRange daterange = 2;
}

message SummaryReturn {
    required float temperature_c = 1;
    required float wind = 2;
    required float precip = 3;
}

message AnalysisReturn {
    repeated PrecipitationEvent events = 1;
}

message GetPrecipReturn {
    repeated PrecipitationEvent return_list = 1;
    required int32 match_days = 2;
    required float max_precip = 3;
    required string max_precip_date = 4;
}

message Location {
  required double lat = 1;
  required double lon = 2;
}

message DateRange {
  required string start_date = 1; // YYYY-MM-DD
  required string end_date = 2;   // YYYY-MM-DD
}

message PrecipitationEvent {
  required string date = 1;
  required float precipitation_mm = 2;
}